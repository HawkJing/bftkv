\section{Security Analysis for $\mathcal{TPA}$}
\label{tpa}
\subsubsection*{Correctness}
Assume $\{Y_i\}_{\{i \in \mathcal{T}\}}$ is correctly calculated,
$G_S$ will be:
\[
  G_S = \prod_{j \in \mathcal{T}}Y_i^{\lambda_j} = g_{\pi}^{a \sum_{j
      \in \mathcal{T}} f(j) \lambda_j} = (g_{\pi}^S)^a \bmod p
\]
and by raising $s_i = g_{\pi}^{h(ID_i)} \bmod p$ to $G_S$, we get:
\[
  X_i = G_S^{s_i} = (g_{\pi}^{Ssi})^a \bmod p
\]
which must be the same as $v_i^a \bmod p$ for each $i \in
\mathcal{T}$ iff the correct password ($g_{\pi}$) is given at the
step 1. With each $B_i = v_i^{b_i} \bmod p$, the client and servers
share Diffie-Hellman session keys $K_i = g_{\pi}^{Ss_iab_i} \bmod p$.

\begin{lemma}
\label{tpa1}
From $\{Y_i\}_{i \in \mathcal{L}}$ where $L \subset \{1..n\}$ and $|L| <
t$, correct $G_S$ cannot be obtained.
\end{lemma}

\begin{proof}
$S$ cannot be reconstructed from $|L|$ servers, from the SSS
  property.
\end{proof}

\subsection{Reducation to DH}

The protocol can be seen as SRP with the password $x = \pi g^S$ which
masks the password with the shared secret. In fact, the $B_i$ part is
the same as SRP except the random exponent $a$ for $X = g^a$ is $a' =
a - g^{\pi'}$. Therefore if we agree that $a'$ is as random as $a$,
the SRP part is secure. If $a$ is one time generated pseudo random
number $F(\pi') = a - g^{pi'}$ is a secure PRF as the function $F$ can
be seen as the onetime pad. Therefore it is semantically impossible to
retrieve the password secret $\pi'$ from $a'$. Also $a'$ is as random
as $a$ from the property of onetime pad.

The protocol is one roundtrip therefore it gives only implicit
authentication for clients. The server gives $Z_i = E_{K_i}(P_i,
X||B_i)$ before confirming the authenticity of the client. It will 
no longer have the zero knowledge property the original SRP has. The
reason of this is even when one server is compromised it will be
possible to do brute force attacks on $x$. Even if it is
infeasible unlike the simple password authentiation, the security
analysis is under the assumption where some servers (less than $t$)
are compromised, therefore we decided to break the ZK property and to
simplify the protocol.

\subsection{(In)possibility of offline dictionary attacks}
Assume we have $\mathcal{L}$ compromised servers and try to reconstruct $g^S
\bmod p$ from ${y_i}$. From the Lemma ~\ref{tpa1} we need at least one
$Y_j$, $j \notin \mathcal{L}$, and unless the server $j$ is not
compromised the only way to get $Y_j$ is to issue the protocol $X =
g^{a'} \bmod q$ and let the server cancel out the $g^{\pi'}$ by
$Xg^{y_i} \bmod p$ with the correct password ($pi'$). To guess the
password 
